library(ggplot2)
library(dplyr)
library(tidyr)

results <- tibble(
  publ = c(0.61387, 0.60554, 0.66981, 0.66919, 0.66375, 0.67273, 0.69172, 0.69031, 0.68409, 0.69406, 0.69174, 0.68820, 0.68644, 0.67012, 0.68994, 0.68813, 0.68130, 0.68264, 0.68572, 0.68083, 0.68470, 0.69072, 0.69078, 0.68092, 0.68994, 0.69085, 0.68695, 0.69097, 0.69214, 0.69234, 0.68311, 0.68481, 0.68887, 0.69138, 0.69214, 0.68965, 0.68658, 0.68965, 0.68786, 0.68313, 0.68708, 0.69138, 0.69461, 0.68917, 0.69138, 0.68931, 0.69153, 0.68765, 0.68365, 0.67997, 0.69611, 0.69805, 0.69651, 0.69749, 0.69668, 0.69251, 0.69824, 0.68556, 0.69721, 0.69351, 0.69839, 0.69953, 0.68965, 0.69805, 0.70034, 0.70029, 0.68568, 0.69655, 0.69670, 0.70096, 0.68480, 0.68843, 0.69146, 0.69302, 0.69256, 0.69537, 0.68703, 0.68355, 0.68895, 0.68855, 0.68670, 0.69967, 0.68793, 0.70019, 0.68446, 0.69931, 0.69510, 0.69700, 0.69740, 0.69658, 0.69279, 0.68643, 0.69260, 0.69510, 0.68967, 0.69727, 0.69820, 0.69490, 0.69866, 0.70044, 0.69900, 0.69634, 0.69147, 0.69754, 0.69997, 0.69836, 0.69571, 0.69672, 0.69563, 0.69665, 0.70084, 0.69908, 0.69898, 0.69843, 0.69983, 0.68577, 0.70144, 0.70166, 0.69983, 0.70158, 0.70112, 0.70371, 0.70203, 0.70138, 0.69136, 0.69449, 0.69569, 0.69362, 0.69569, 0.70357, 0.70495),
  priv = c(0.60852, 0.59507, 0.67628, 0.67641, 0.66923, 0.67453, 0.68745, 0.68663, 0.68303, 0.68834, 0.68823, 0.68063, 0.68098, 0.66743, 0.68248, 0.69065, 0.67974, 0.67349, 0.68694, 0.67722, 0.68181, 0.68719, 0.69124, 0.67569, 0.68248, 0.68626, 0.68436, 0.69197, 0.68711, 0.68970, 0.67596, 0.67700, 0.68829, 0.68213, 0.68390, 0.68638, 0.68145, 0.68638, 0.68758, 0.68267, 0.68730, 0.68853, 0.68965, 0.68652, 0.68517, 0.68844, 0.68454, 0.68636, 0.68706, 0.67526, 0.69171, 0.69049, 0.68623, 0.69139, 0.69277, 0.68717, 0.69329, 0.68562, 0.69239, 0.68791, 0.69431, 0.69258, 0.68692, 0.69049, 0.69295, 0.69519, 0.68498, 0.69557, 0.69262, 0.69111, 0.68851, 0.68297, 0.69068, 0.69143, 0.68955, 0.69103, 0.68485, 0.68349, 0.68411, 0.68309, 0.68917, 0.68905, 0.68840, 0.69411, 0.68181, 0.69049, 0.69465, 0.69381, 0.69466, 0.68842, 0.68404, 0.67123, 0.68676, 0.69121, 0.68649, 0.68682, 0.68756, 0.69452, 0.69457, 0.69219, 0.69400, 0.69234, 0.68540, 0.69296, 0.69516, 0.69454, 0.68193, 0.69212, 0.68769, 0.69042, 0.69201, 0.69678, 0.69528, 0.69371, 0.69537, 0.68748, 0.69412, 0.69453, 0.69627, 0.68814, 0.69314, 0.69425, 0.69388, 0.69575, 0.68967, 0.68975, 0.68952, 0.68938, 0.68856, 0.69366, 0.69423)
) %>% 
  mutate(id = 1:nrow(.))

max_publ <- results %>% .[.$publ ==max(.$publ), ] %>% 
  gather(key, value, -id)%>% 
  mutate(key = ifelse(key=='publ', 'Publico', 'Privado'))

max_priv <- results %>% .[.$priv ==max(.$priv), ] %>% 
  gather(key, value, -id)%>% 
  mutate(key = ifelse(key=='publ', 'Publico', 'Privado'))

results %>% 
  gather(key, value, -id) %>% 
  mutate(key = ifelse(key=='publ', 'Publico', 'Privado')) %>% 
  ggplot(aes(x=id, y=value))+
  geom_line()+
  geom_point(data=max_priv, color='red')+
  geom_point(data=max_publ, color='red')+
  theme_bw()+
  theme(legend.position = 'bottom')+
  facet_wrap(~key)+
  labs(y='F1', x='i-ésima submissão')+
  scale_x_continuous(breaks = seq(0, 200, 20))

